"use client"
import Image from 'next/image';
import Link from 'next/link';
import img from "@/assets/book.webp";
import React from 'react'
import toast from 'react-hot-toast';
import { FieldValues, SubmitHandler, useForm } from 'react-hook-form';
import { useUser } from '@/context/UserContext';
import { useRouter, useSearchParams } from "next/navigation";
import { loginUser } from '@/services/AuthService';
import { zodResolver } from "@hookform/resolvers/zod";
import { loginSchema } from './Validation';

const Login = () => {
    const {handleSubmit, register} = useForm({
        resolver: zodResolver(loginSchema),
    });

    const searchParams = useSearchParams();
    const redirect = searchParams.get("redirectPath");
    const router = useRouter();
    const { setIsLoading } = useUser()

    const onSubmit: SubmitHandler<FieldValues> = async (data) => {
        try {
            const res = await loginUser(data);
            setIsLoading(true)
            console.log(res);

            if (res?.success) {
                toast.success(res?.message);
                router.push("/");
                if (redirect) {
                    router.push(redirect);
                } else {
                    router.push("/");
                }
            } else {
                toast.success(res?.message);
                router.push('/')
            }
        } catch (error) {
            console.error(error);
        }
        console.log(data);
    };
    return (
        <div className="lg:flex h-screen">
            {/* Left Section */}
            <div
                className="w-1/2 bg-cover bg-center relative hidden lg:block"
            >
                <Image src={img} alt="bannerimage " width={1000} height={1000} />
                <div className="absolute inset-0 bg-opacity-50 flex justify-center items-center">
                    <h2 className="text-white text-3xl font-bold">Read Your Book</h2>
                </div>
            </div>

            {/* Right Section */}
            <div className="w-1/2 flex justify-center items-center bg-white">
                <div className="w-full p-8">
                    {/* Logo */}
                    <div className="flex flex-col flex-wrap items-center justify-center">
                        <Link href="/">
                            <svg
                                width="150"
                                height="140"
                                viewBox="0 0 190 162"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <path
                                    d="M134.316 132.766C133.546 132.766 132.9 132.527 132.38 132.048C131.881 131.549 131.631 130.935 131.631 130.207C131.631 129.478 131.881 128.875 132.38 128.396C132.9 127.897 133.546 127.647 134.316 127.647C135.086 127.647 135.72 127.897 136.22 128.396C136.74 128.875 137 129.478 137 130.207C137 130.935 136.74 131.549 136.22 132.048C135.72 132.527 135.086 132.766 134.316 132.766ZM136.469 134.826V152.12H132.099V134.826H136.469ZM150.516 134.577C152.576 134.577 154.241 135.232 155.51 136.543C156.78 137.834 157.414 139.644 157.414 141.975V152.12H153.044V142.568C153.044 141.195 152.701 140.144 152.014 139.415C151.327 138.666 150.391 138.291 149.205 138.291C147.998 138.291 147.04 138.666 146.333 139.415C145.646 140.144 145.303 141.195 145.303 142.568V152.12H140.932V134.826H145.303V136.98C145.885 136.231 146.624 135.648 147.519 135.232C148.435 134.795 149.434 134.577 150.516 134.577ZM168.489 134.546C169.78 134.546 170.914 134.806 171.892 135.326C172.87 135.825 173.64 136.481 174.202 137.293V134.826H178.603V152.245C178.603 153.847 178.281 155.273 177.636 156.522C176.991 157.791 176.023 158.79 174.733 159.518C173.442 160.267 171.882 160.642 170.05 160.642C167.595 160.642 165.576 160.07 163.994 158.925C162.434 157.781 161.549 156.22 161.341 154.243H165.68C165.909 155.034 166.398 155.658 167.147 156.116C167.917 156.594 168.843 156.834 169.925 156.834C171.195 156.834 172.225 156.449 173.016 155.679C173.807 154.93 174.202 153.785 174.202 152.245V149.56C173.64 150.372 172.86 151.048 171.861 151.589C170.883 152.131 169.759 152.401 168.489 152.401C167.033 152.401 165.701 152.026 164.494 151.277C163.287 150.528 162.329 149.477 161.622 148.124C160.935 146.751 160.592 145.18 160.592 143.411C160.592 141.663 160.935 140.112 161.622 138.76C162.329 137.407 163.276 136.366 164.463 135.638C165.67 134.91 167.012 134.546 168.489 134.546ZM174.202 143.473C174.202 142.412 173.994 141.507 173.578 140.758C173.161 139.988 172.6 139.405 171.892 139.009C171.184 138.593 170.425 138.385 169.613 138.385C168.802 138.385 168.052 138.583 167.366 138.978C166.679 139.374 166.117 139.956 165.68 140.726C165.264 141.475 165.056 142.37 165.056 143.411C165.056 144.451 165.264 145.367 165.68 146.158C166.117 146.928 166.679 147.521 167.366 147.937C168.073 148.353 168.822 148.561 169.613 148.561C170.425 148.561 171.184 148.364 171.892 147.968C172.6 147.552 173.161 146.969 173.578 146.22C173.994 145.45 174.202 144.535 174.202 143.473Z"
                                    fill="#40282C"
                                />
                                <path
                                    d="M48.4949 134.117C49.8481 134.117 51.0509 134.407 52.1034 134.987C53.1774 135.567 54.0151 136.426 54.6165 137.564C55.2394 138.703 55.5508 140.077 55.5508 141.688V152.159H51.9101V142.236C51.9101 140.646 51.5127 139.433 50.718 138.595C49.9233 137.736 48.8386 137.306 47.4639 137.306C46.0892 137.306 44.9938 137.736 44.1776 138.595C43.3828 139.433 42.9855 140.646 42.9855 142.236V152.159H39.3125V128.317H42.9855V136.469C43.6084 135.717 44.3924 135.137 45.3374 134.729C46.304 134.321 47.3565 134.117 48.4949 134.117Z"
                                    fill="#40282C"
                                />
                                <path
                                    d="M18.7656 143.268C18.7656 141.443 19.1308 139.842 19.8611 138.468C20.6128 137.072 21.6438 135.998 22.9541 135.246C24.2643 134.494 25.7679 134.118 27.4647 134.118C29.6127 134.118 31.3847 134.634 32.7809 135.665C34.1985 136.674 35.1543 138.124 35.6483 140.014H31.6854C31.3632 139.134 30.8477 138.446 30.1389 137.952C29.4301 137.458 28.5387 137.211 27.4647 137.211C25.9612 137.211 24.7583 137.748 23.8562 138.822C22.9756 139.875 22.5352 141.357 22.5352 143.268C22.5352 145.18 22.9756 146.673 23.8562 147.747C24.7583 148.821 25.9612 149.358 27.4647 149.358C29.5912 149.358 30.9981 148.423 31.6854 146.555H35.6483C35.1328 148.359 34.1663 149.798 32.7486 150.872C31.331 151.924 29.5697 152.451 27.4647 152.451C25.7679 152.451 24.2643 152.075 22.9541 151.323C21.6438 150.55 20.6128 149.476 19.8611 148.101C19.1308 146.705 18.7656 145.094 18.7656 143.268Z"
                                    fill="#40282C"
                                />
                                <path
                                    d="M7.92586 152.385C6.42231 152.385 5.06911 152.127 3.86627 151.612C2.66343 151.075 1.71834 150.323 1.03101 149.357C0.343669 148.39 0 147.262 0 145.974H3.93071C4.01663 146.94 4.39251 147.735 5.05837 148.358C5.74571 148.981 6.70154 149.292 7.92586 149.292C9.19314 149.292 10.1812 148.991 10.89 148.39C11.5988 147.767 11.9532 146.972 11.9532 146.006C11.9532 145.254 11.7277 144.642 11.2766 144.169C10.847 143.697 10.2993 143.332 9.63346 143.074C8.98908 142.816 8.08695 142.537 6.92707 142.236C5.46648 141.85 4.27438 141.463 3.35077 141.076C2.44864 140.668 1.67538 140.045 1.03101 139.208C0.386627 138.37 0.0644379 137.253 0.0644379 135.857C0.0644379 134.568 0.386627 133.44 1.03101 132.474C1.67538 131.507 2.57751 130.766 3.7374 130.251C4.89728 129.735 6.23973 129.478 7.76476 129.478C9.93417 129.478 11.7062 130.025 13.0809 131.121C14.477 132.195 15.2503 133.677 15.4006 135.567H11.3411C11.2766 134.751 10.89 134.053 10.1812 133.473C9.47237 132.893 8.53802 132.603 7.37813 132.603C6.32565 132.603 5.46648 132.871 4.80062 133.408C4.13476 133.945 3.80183 134.718 3.80183 135.728C3.80183 136.415 4.00589 136.985 4.41399 137.436C4.84358 137.865 5.38056 138.209 6.02494 138.467C6.66932 138.724 7.54997 139.004 8.66689 139.304C10.149 139.712 11.3518 140.121 12.2754 140.529C13.2205 140.937 14.0152 141.57 14.6596 142.43C15.3255 143.267 15.6584 144.395 15.6584 145.813C15.6584 146.951 15.347 148.025 14.7241 149.034C14.1226 150.044 13.2312 150.86 12.0499 151.483C10.89 152.084 9.51532 152.385 7.92586 152.385Z"
                                    fill="#40282C"
                                />
                                <path
                                    d="M59.5781 135.753H61.3238"
                                    stroke="#40282C"
                                    strokeWidth="1.39655"
                                    strokeLinecap="round"
                                    strokeLinejoin="round"
                                />
                                <path
                                    d="M83.1028 135.754C83.1028 129.74 78.2275 124.864 72.2135 124.864C66.1995 124.864 61.3242 129.74 61.3242 135.754"
                                    stroke="#40282C"
                                    strokeWidth="1.39655"
                                    strokeLinecap="round"
                                    strokeLinejoin="round"
                                />
                                <path
                                    d="M83.1016 135.754C83.1016 135.754 83.4507 133.659 86.6802 133.659C89.9098 133.659 90.2589 135.754 90.2589 135.754"
                                    stroke="#40282C"
                                    strokeWidth="1.39655"
                                    strokeLinecap="round"
                                    strokeLinejoin="round"
                                />
                                <path
                                    d="M112.036 135.754C112.036 129.74 107.161 124.864 101.147 124.864C95.1331 124.864 90.2578 129.74 90.2578 135.754"
                                    stroke="#40282C"
                                    strokeWidth="1.39655"
                                    strokeLinecap="round"
                                    strokeLinejoin="round"
                                />
                                <path
                                    d="M112.039 135.753H113.785"
                                    stroke="#40282C"
                                    strokeWidth="1.39655"
                                    strokeLinecap="round"
                                    strokeLinejoin="round"
                                />
                                <circle
                                    cx="72.8894"
                                    cy="141.561"
                                    r="9.12279"
                                    stroke="#40282C"
                                    strokeWidth="3.53315"
                                />
                                <circle cx="75.1701" cy="141.16" r="2.17787" fill="#40282C" />
                                <circle
                                    cx="100.475"
                                    cy="141.561"
                                    r="9.12279"
                                    stroke="#40282C"
                                    strokeWidth="3.53315"
                                />
                                <circle cx="102.705" cy="140.953" r="2.17787" fill="#40282C" />
                                <path
                                    d="M8.79635 71.9463C6.2706 71.0098 6.27061 67.4374 8.79635 66.5009L68.6577 44.3058C69.9604 43.8228 71.393 43.8228 72.6957 44.3058L132.557 66.5009C135.083 67.4373 135.083 71.0097 132.557 71.9462L72.6956 94.1413C71.3929 94.6243 69.9603 94.6243 68.6576 94.1413L8.79635 71.9463Z"
                                    fill="#40282C"
                                />
                                <path
                                    d="M31.9453 85.6592L68.2815 100.057C69.6557 100.601 71.1859 100.601 72.5601 100.057L108.896 85.6592V103.146C108.896 107.924 105.97 112.207 101.382 113.542C94.1516 115.645 82.5544 118.327 70.4208 118.327C58.2873 118.327 46.6901 115.645 39.4593 113.542C34.8713 112.207 31.9453 107.924 31.9453 103.146V85.6592Z"
                                    fill="#40282C"
                                />
                                <path
                                    fillRule="evenodd"
                                    clipRule="evenodd"
                                    d="M124.863 87.0034C124.863 85.3844 123.16 84.3315 121.711 85.0555L120.26 85.7814C119.522 86.1504 119.056 86.9045 119.056 87.7294V110.395C119.056 111.222 118.567 111.954 117.917 112.466C116.4 113.662 115.426 115.517 115.426 117.599C115.426 119.681 116.4 121.536 117.917 122.733C118.567 123.245 119.056 123.976 119.056 124.803V149.541C119.056 151.145 120.356 152.445 121.959 152.445C123.563 152.445 124.863 151.145 124.863 149.541V124.803C124.863 123.976 125.352 123.244 126.001 122.733C127.519 121.536 128.493 119.681 128.493 117.599C128.493 115.517 127.519 113.662 126.001 112.466C125.352 111.954 124.863 111.222 124.863 110.395V87.0034Z"
                                    fill="#40282C"
                                />
                                <path
                                    d="M119.055 82.9098L124.862 80.5791V149.545C124.862 151.148 123.562 152.448 121.958 152.448C120.355 152.448 119.055 151.148 119.055 149.545V82.9098Z"
                                    fill="#40282C"
                                />
                            </svg>
                        </Link>
                        <h2 className="text-2xl font-semibold mt-2 mb-5">Sign IN</h2>
                    </div>



                    <form onSubmit={handleSubmit(onSubmit)}>

                        <div className="w-full flex gap-2">
                            <div className="w-full">
                                <label className="block text-lg font-[500] ">Email</label>
                                <input {...register("email", { required: true })} type="email" placeholder="Enter User Email" className="w-full p-2.5 border rounded-md mt-1" />
                            </div>
                            <div className="w-full">
                                <label className="block text-lg font-[500] ">Password</label>
                                <input {...register("password", { required: true })} type="password" placeholder="Enter Password" className="w-full p-2.5 border rounded-md mt-1" />

                            </div>
                        </div>

                        {/* Login Button */}
                        <button className="mt-2 bg-[#40282C] w-full hover:bg-[#5d313a] text-white font-bold py-2 px-4 rounded">Sign IN</button>
                    </form>

                    <div className="text-center mt-4">
                        <Link href="/signup" className="text-lg ">You Haven&apos;t an Account ? <span className="underline text-blue-400">Click To SignUp</span> </Link>
                    </div>
                </div>
            </div>
        </div>
    );
}

export default Login
